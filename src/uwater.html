<!DOCTYPE html>
<!-- Generated by Cython 0.29.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: uwater.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.21</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="uwater.cpp">uwater.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: # cython: language_level=3, boundscheck=False, cdivision=True, wraparound=False</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: # distutils: language=c++</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: import cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: from cython.parallel import prange</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: cimport openmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: cimport libc.stdio</pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: from cython.parallel cimport parallel, threadid</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: from libc.math cimport fabs, M_PI, exp</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: from libc.stdlib cimport malloc, free</pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: from water cimport els_mapS, els_mapB</pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: cimport la</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: from la cimport respT</pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: cdef void water_HOH_w20(double[:] w, double[:] eF, els_mapB emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_HOH_w20(__Pyx_memviewslice __pyx_v_w, __Pyx_memviewslice __pyx_v_eF, struct __pyx_t_5water_els_mapB __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">019</span>:                         int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>:    cdef int nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">024</span>:       nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">025</span>:       w[nsi] = (emap.w21_0 + emap.w10_0) + \</pre>
<pre class='cython code score-0 '>                            __pyx_t_7 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_w.data + __pyx_t_7 * __pyx_v_w.strides[0]) )) = (((__pyx_v_emap.w21_0 + __pyx_v_emap.w10_0) + ((__pyx_v_emap.w21_1 + __pyx_v_emap.w10_1) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_4 * __pyx_v_eF.strides[0]) ))))) + (((__pyx_v_emap.w21_2 + __pyx_v_emap.w10_2) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_5 * __pyx_v_eF.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_6 * __pyx_v_eF.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">026</span>:                (emap.w21_1 + emap.w10_1)*eF[nsi] + \</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>:                (emap.w21_2 + emap.w10_2)*eF[nsi]*eF[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_5 = __pyx_v_nsi;
                            __pyx_t_6 = __pyx_v_nsi;
</pre><pre class="cython line score-0">&#xA0;<span class="">028</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">030</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>: cdef void water_HOH_w10(double[:] w10, double[:] eF, els_mapB emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_HOH_w10(__Pyx_memviewslice __pyx_v_w10, __Pyx_memviewslice __pyx_v_eF, struct __pyx_t_5water_els_mapB __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">032</span>:                         int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>:    cdef int  nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:      nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:      w10[nsi] = emap.w10_0 + emap.w10_1*eF[nsi] + emap.w10_2*eF[nsi]*eF[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            __pyx_t_6 = __pyx_v_nsi;
                            __pyx_t_7 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_w10.data + __pyx_t_7 * __pyx_v_w10.strides[0]) )) = ((__pyx_v_emap.w10_0 + (__pyx_v_emap.w10_1 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_4 * __pyx_v_eF.strides[0]) ))))) + ((__pyx_v_emap.w10_2 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_5 * __pyx_v_eF.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_6 * __pyx_v_eF.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">039</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">041</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>: cdef void water_HOH_t20(double[:] t, double[:] w, els_mapB emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_HOH_t20(__Pyx_memviewslice __pyx_v_t, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_w, CYTHON_UNUSED struct __pyx_t_5water_els_mapB __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">043</span>:                         int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>:    cdef int  nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:      nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:      t[nsi] = 0.0 #emap.t21_0 + emap.t21_1*w[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_4 * __pyx_v_t.strides[0]) )) = 0.0;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">050</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">051</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">052</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>: cdef void water_HOH_t10(double[:] t10, double[:] w, els_mapB emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_HOH_t10(__Pyx_memviewslice __pyx_v_t10, __Pyx_memviewslice __pyx_v_w, struct __pyx_t_5water_els_mapB __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">054</span>:                         int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>:    cdef int nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:      nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:      t10[nsi] = emap.t10_0 + emap.t10_1*w[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_t10.data + __pyx_t_5 * __pyx_v_t10.strides[0]) )) = (__pyx_v_emap.t10_0 + (__pyx_v_emap.t10_1 * (*((double *) ( /* dim=0 */ (__pyx_v_w.data + __pyx_t_4 * __pyx_v_w.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">061</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">063</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>: cdef void water_HOH_m(double[:] m10, double[:] eF, els_mapB emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_HOH_m(__Pyx_memviewslice __pyx_v_m10, __Pyx_memviewslice __pyx_v_eF, struct __pyx_t_5water_els_mapB __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">065</span>:                         int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>:    cdef int  nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:       nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>:       m10[nsi] = emap.m0 + emap.m1*eF[nsi] + emap.m2*eF[nsi]*eF[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            __pyx_t_6 = __pyx_v_nsi;
                            __pyx_t_7 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_m10.data + __pyx_t_7 * __pyx_v_m10.strides[0]) )) = ((__pyx_v_emap.m0 + (__pyx_v_emap.m1 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_4 * __pyx_v_eF.strides[0]) ))))) + ((__pyx_v_emap.m2 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_5 * __pyx_v_eF.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_6 * __pyx_v_eF.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">072</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">074</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>: cdef void water_OH_w10(double[:] w10, double [:] eF, els_mapS emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_OH_w10(__Pyx_memviewslice __pyx_v_w10, __Pyx_memviewslice __pyx_v_eF, struct __pyx_t_5water_els_mapS __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">076</span>:                          int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>:    cdef int nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:       nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:       w10[nsi] = emap.w10_0 + emap.w10_1*eF[nsi] + emap.w10_2*eF[nsi]*eF[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            __pyx_t_6 = __pyx_v_nsi;
                            __pyx_t_7 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_w10.data + __pyx_t_7 * __pyx_v_w10.strides[0]) )) = ((__pyx_v_emap.w10_0 + (__pyx_v_emap.w10_1 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_4 * __pyx_v_eF.strides[0]) ))))) + ((__pyx_v_emap.w10_2 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_5 * __pyx_v_eF.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_6 * __pyx_v_eF.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">083</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">085</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>: cdef void water_OH_x10(double [:] x10, double [:] w10, els_mapS emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_OH_x10(__Pyx_memviewslice __pyx_v_x10, __Pyx_memviewslice __pyx_v_w10, struct __pyx_t_5water_els_mapS __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">087</span>:                         int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:    cdef int nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:       nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:       x10[nsi] = emap.x10_0 + emap.x10_1*w10[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_x10.data + __pyx_t_5 * __pyx_v_x10.strides[0]) )) = (__pyx_v_emap.x10_0 + (__pyx_v_emap.x10_1 * (*((double *) ( /* dim=0 */ (__pyx_v_w10.data + __pyx_t_4 * __pyx_v_w10.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">094</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">096</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>: cdef void water_OH_p10(double [:] p10, double [:] w10, els_mapS emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_OH_p10(__Pyx_memviewslice __pyx_v_p10, __Pyx_memviewslice __pyx_v_w10, struct __pyx_t_5water_els_mapS __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">098</span>:                        int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:    cdef int nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>:       nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:       p10[nsi] = emap.p10_0 + emap.p10_1*w10[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_p10.data + __pyx_t_5 * __pyx_v_p10.strides[0]) )) = (__pyx_v_emap.p10_0 + (__pyx_v_emap.p10_1 * (*((double *) ( /* dim=0 */ (__pyx_v_w10.data + __pyx_t_4 * __pyx_v_w10.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">105</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">107</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>: cdef void water_OH_m(double [:] m, double [:] eF, els_mapS emap,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_OH_m(__Pyx_memviewslice __pyx_v_m, __Pyx_memviewslice __pyx_v_eF, struct __pyx_t_5water_els_mapS __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads, int __pyx_v_si) {
  Py_ssize_t __pyx_v_n;
  int __pyx_v_nsi;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">109</span>:                      int nchrom, int num_threads, int si) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>:    cdef int nsi</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_nsi) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_nsi = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:       nsi = n+si</pre>
<pre class='cython code score-0 '>                            __pyx_v_nsi = (__pyx_v_n + __pyx_v_si);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:       m[nsi] = emap.m0 + emap.m1*eF[nsi] + emap.m2*eF[nsi]*eF[nsi]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_nsi;
                            __pyx_t_5 = __pyx_v_nsi;
                            __pyx_t_6 = __pyx_v_nsi;
                            __pyx_t_7 = __pyx_v_nsi;
                            *((double *) ( /* dim=0 */ (__pyx_v_m.data + __pyx_t_7 * __pyx_v_m.strides[0]) )) = ((__pyx_v_emap.m0 + (__pyx_v_emap.m1 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_4 * __pyx_v_eF.strides[0]) ))))) + ((__pyx_v_emap.m2 * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_5 * __pyx_v_eF.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_6 * __pyx_v_eF.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">116</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">118</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>: cdef void water_OH_intra(double [:,:] Vii, double [:] x10, double [:] p10,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_OH_intra(__Pyx_memviewslice __pyx_v_Vii, __Pyx_memviewslice __pyx_v_x10, __Pyx_memviewslice __pyx_v_p10, __Pyx_memviewslice __pyx_v_eF, struct __pyx_t_5water_els_mapS __pyx_v_emap, CYTHON_UNUSED int __pyx_v_nmol, CYTHON_UNUSED int __pyx_v_num_threads) {
  Py_ssize_t __pyx_v_n;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">120</span>:                          double [:] eF, els_mapS emap, int nmol, int num_threads) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:    for n in prange(nmol, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nmol;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nmol;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:      Vii[2*n+1, 2*n] = (emap.v0 + emap.ve*(eF[2*n] + eF[2*n+1]))*x10[2*n]*x10[2*n+1] + emap.vp*p10[2*n]*p10[2*n+1]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = (2 * __pyx_v_n);
                            __pyx_t_5 = ((2 * __pyx_v_n) + 1);
                            __pyx_t_6 = (2 * __pyx_v_n);
                            __pyx_t_7 = ((2 * __pyx_v_n) + 1);
                            __pyx_t_8 = (2 * __pyx_v_n);
                            __pyx_t_9 = ((2 * __pyx_v_n) + 1);
                            __pyx_t_10 = ((2 * __pyx_v_n) + 1);
                            __pyx_t_11 = (2 * __pyx_v_n);
                            *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Vii.data + __pyx_t_10 * __pyx_v_Vii.strides[0]) ) + __pyx_t_11 * __pyx_v_Vii.strides[1]) )) = ((((__pyx_v_emap.v0 + (__pyx_v_emap.ve * ((*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_4 * __pyx_v_eF.strides[0]) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_eF.data + __pyx_t_5 * __pyx_v_eF.strides[0]) )))))) * (*((double *) ( /* dim=0 */ (__pyx_v_x10.data + __pyx_t_6 * __pyx_v_x10.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_x10.data + __pyx_t_7 * __pyx_v_x10.strides[0]) )))) + ((__pyx_v_emap.vp * (*((double *) ( /* dim=0 */ (__pyx_v_p10.data + __pyx_t_8 * __pyx_v_p10.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_p10.data + __pyx_t_9 * __pyx_v_p10.strides[0]) )))));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">125</span>:      #Vii[2*n, 2*n+1] = Vii[2*n+1, 2*n]</pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">128</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>: cdef void water_trans_dip(double complex [:] tdmV, double [:,:] tmu,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_trans_dip(__Pyx_memviewslice __pyx_v_tdmV, __Pyx_memviewslice __pyx_v_tmu, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_m, int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads) {
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_d;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">130</span>:                           double [:] x, double [:] m, int nchrom,</pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>:                           int num_threads) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>:    cdef Py_ssize_t n, d</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_d) firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_d) firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_d = ((Py_ssize_t)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:       for d in range(3):</pre>
<pre class='cython code score-0 '>                            for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
                              __pyx_v_d = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         tdmV[d*nchrom+n] = tmu[n,d]*x[n]*m[n]</pre>
<pre class='cython code score-0 '>                              __pyx_t_5 = __pyx_v_n;
                              __pyx_t_6 = __pyx_v_d;
                              __pyx_t_7 = __pyx_v_n;
                              __pyx_t_8 = __pyx_v_n;
                              __pyx_t_9 = ((__pyx_v_d * __pyx_v_nchrom) + __pyx_v_n);
                              *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tdmV.data + __pyx_t_9 * __pyx_v_tdmV.strides[0]) )) = __pyx_t_double_complex_from_parts((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_5 * __pyx_v_tmu.strides[0]) ) + __pyx_t_6 * __pyx_v_tmu.strides[1]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_7 * __pyx_v_x.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_m.data + __pyx_t_8 * __pyx_v_m.strides[0]) )))), 0);
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>: cdef void IRTCF(double complex [:] tdmV, double complex [:] tdmV0,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_IRTCF(__Pyx_memviewslice __pyx_v_tdmV, __Pyx_memviewslice __pyx_v_tdmV0, __Pyx_memviewslice __pyx_v_Fmt, int __pyx_v_nchrom, double __pyx_v_tdt, double __pyx_v_rlx_time, __Pyx_memviewslice __pyx_v_mtcf, int __pyx_v_it) {
  __pyx_t_double_complex __pyx_v_mx;
  __pyx_t_double_complex __pyx_v_my;
  __pyx_t_double_complex __pyx_v_mz;
  double __pyx_v_dts;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IRTCF", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">140</span>:                 double complex [:,:] Fmt, int nchrom, double tdt,</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>:                 double rlx_time, double complex [:] mtcf, int it):</pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>:    cdef double complex mx, my, mz</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:    cdef double dts = -tdt/(2.0*rlx_time)</pre>
<pre class='cython code score-0 '>  __pyx_v_dts = ((-__pyx_v_tdt) / (2.0 * __pyx_v_rlx_time));
</pre><pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:    mx = respT(tdmV, tdmV0, Fmt, nchrom, 0, 0)</pre>
<pre class='cython code score-0 '>  __pyx_v_mx = __pyx_f_2la_respT(__pyx_v_tdmV, __pyx_v_tdmV0, __pyx_v_Fmt, __pyx_v_nchrom, 0, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:    my = respT(tdmV, tdmV0, Fmt, nchrom, nchrom, nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_my = __pyx_f_2la_respT(__pyx_v_tdmV, __pyx_v_tdmV0, __pyx_v_Fmt, __pyx_v_nchrom, __pyx_v_nchrom, __pyx_v_nchrom);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:    mz = respT(tdmV, tdmV0, Fmt, nchrom, 2*nchrom, 2*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_mz = __pyx_f_2la_respT(__pyx_v_tdmV, __pyx_v_tdmV0, __pyx_v_Fmt, __pyx_v_nchrom, (2 * __pyx_v_nchrom), (2 * __pyx_v_nchrom));
</pre><pre class="cython line score-0">&#xA0;<span class="">149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>:    # averaging over x y z</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:    mtcf[it] += (mx + my + mz)*exp(dts) #/3.0</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_it;
  *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_mtcf.data + __pyx_t_1 * __pyx_v_mtcf.strides[0]) )) += __Pyx_c_prod_double(__Pyx_c_sum_double(__Pyx_c_sum_double(__pyx_v_mx, __pyx_v_my), __pyx_v_mz), __pyx_t_double_complex_from_parts(exp(__pyx_v_dts), 0));
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">154</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>: cdef void water_trans_pol(double complex [:] tpol, double [:,:] tmu,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_trans_pol(__Pyx_memviewslice __pyx_v_tpol, __Pyx_memviewslice __pyx_v_tmu, __Pyx_memviewslice __pyx_v_x, double __pyx_v_tbp, int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads) {
  Py_ssize_t __pyx_v_n;
  double __pyx_v_tbpo;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">156</span>:                           double [:] x, double tbp, int nchrom,</pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>:                           int num_threads) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:    """</pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>:       Calculate transition polarizability tensor for OH stretch</pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>:    """</pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:    cdef double tbpo = tbp-1.0</pre>
<pre class='cython code score-0 '>  __pyx_v_tbpo = (__pyx_v_tbp - 1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>:    # xx</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:       tpol[n] =  (tbpo*tmu[n,0]*tmu[n,0]+1.0)*x[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_n;
                            __pyx_t_5 = 0;
                            __pyx_t_6 = __pyx_v_n;
                            __pyx_t_7 = 0;
                            __pyx_t_8 = __pyx_v_n;
                            __pyx_t_9 = __pyx_v_n;
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_9 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((((__pyx_v_tbpo * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_4 * __pyx_v_tmu.strides[0]) ) + __pyx_t_5 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_6 * __pyx_v_tmu.strides[0]) ) + __pyx_t_7 * __pyx_v_tmu.strides[1]) )))) + 1.0) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_8 * __pyx_v_x.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:    # xy</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_3);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L14;
        }
        __pyx_L14:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:       tpol[nchrom+n] = tbpo*tmu[n,0]*tmu[n,1]*x[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_8 = __pyx_v_n;
                            __pyx_t_7 = 0;
                            __pyx_t_6 = __pyx_v_n;
                            __pyx_t_5 = 1;
                            __pyx_t_4 = __pyx_v_n;
                            __pyx_t_9 = (__pyx_v_nchrom + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_9 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts((((__pyx_v_tbpo * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_8 * __pyx_v_tmu.strides[0]) ) + __pyx_t_7 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_6 * __pyx_v_tmu.strides[0]) ) + __pyx_t_5 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_4 * __pyx_v_x.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:    # xz</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L23;
        }
        __pyx_L23:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:       tpol[2*nchrom+n] = tbpo*tmu[n,0]*tmu[n,2]*x[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_n;
                            __pyx_t_5 = 0;
                            __pyx_t_6 = __pyx_v_n;
                            __pyx_t_7 = 2;
                            __pyx_t_8 = __pyx_v_n;
                            __pyx_t_9 = ((2 * __pyx_v_nchrom) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_9 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts((((__pyx_v_tbpo * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_4 * __pyx_v_tmu.strides[0]) ) + __pyx_t_5 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_6 * __pyx_v_tmu.strides[0]) ) + __pyx_t_7 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_8 * __pyx_v_x.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">175</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:    # yy</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_3);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L32;
        }
        __pyx_L32:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:       tpol[3*nchrom+n] =  (tbpo*tmu[n,1]*tmu[n,1]+1.0)*x[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_8 = __pyx_v_n;
                            __pyx_t_7 = 1;
                            __pyx_t_6 = __pyx_v_n;
                            __pyx_t_5 = 1;
                            __pyx_t_4 = __pyx_v_n;
                            __pyx_t_9 = ((3 * __pyx_v_nchrom) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_9 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((((__pyx_v_tbpo * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_8 * __pyx_v_tmu.strides[0]) ) + __pyx_t_7 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_6 * __pyx_v_tmu.strides[0]) ) + __pyx_t_5 * __pyx_v_tmu.strides[1]) )))) + 1.0) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_4 * __pyx_v_x.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">179</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>:    # yz</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L41;
        }
        __pyx_L41:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:       tpol[4*nchrom+n] = tbpo*tmu[n,1]*tmu[n,2]*x[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_n;
                            __pyx_t_5 = 1;
                            __pyx_t_6 = __pyx_v_n;
                            __pyx_t_7 = 2;
                            __pyx_t_8 = __pyx_v_n;
                            __pyx_t_9 = ((4 * __pyx_v_nchrom) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_9 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts((((__pyx_v_tbpo * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_4 * __pyx_v_tmu.strides[0]) ) + __pyx_t_5 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_6 * __pyx_v_tmu.strides[0]) ) + __pyx_t_7 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_8 * __pyx_v_x.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">183</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:    # zz</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_3);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L50;
        }
        __pyx_L50:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:       tpol[5*nchrom+n] = (tbpo*tmu[n,2]*tmu[n,2]+1.0)*x[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_8 = __pyx_v_n;
                            __pyx_t_7 = 2;
                            __pyx_t_6 = __pyx_v_n;
                            __pyx_t_5 = 2;
                            __pyx_t_4 = __pyx_v_n;
                            __pyx_t_9 = ((5 * __pyx_v_nchrom) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_9 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((((__pyx_v_tbpo * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_8 * __pyx_v_tmu.strides[0]) ) + __pyx_t_7 * __pyx_v_tmu.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tmu.data + __pyx_t_6 * __pyx_v_tmu.strides[0]) ) + __pyx_t_5 * __pyx_v_tmu.strides[1]) )))) + 1.0) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_4 * __pyx_v_x.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">187</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">189</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>: cdef void water_trans_pol_bend(double complex [:] tpol, double [:] tps,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_water_trans_pol_bend(__Pyx_memviewslice __pyx_v_tpol, __Pyx_memviewslice __pyx_v_tps, __Pyx_memviewslice __pyx_v_t, CYTHON_UNUSED int __pyx_v_nmol, int __pyx_v_nchrom, int __pyx_v_si, CYTHON_UNUSED int __pyx_v_num_threads) {
  Py_ssize_t __pyx_v_n;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>:                                double [:] t, int nmol, int nchrom, int si,</pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>:                                int num_threads) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:    for n in prange(nmol, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nmol;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nmol;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:       tpol[si+n]          = t[si+n]*tps[6*n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = (__pyx_v_si + __pyx_v_n);
                            __pyx_t_5 = (6 * __pyx_v_n);
                            __pyx_t_6 = (__pyx_v_si + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_6 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((*((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_4 * __pyx_v_t.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_tps.data + __pyx_t_5 * __pyx_v_tps.strides[0]) )))), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:       tpol[si+nchrom+n]   = t[si+n]*tps[6*n+1]</pre>
<pre class='cython code score-0 '>                            __pyx_t_5 = (__pyx_v_si + __pyx_v_n);
                            __pyx_t_4 = ((6 * __pyx_v_n) + 1);
                            __pyx_t_6 = ((__pyx_v_si + __pyx_v_nchrom) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_6 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((*((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_5 * __pyx_v_t.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_tps.data + __pyx_t_4 * __pyx_v_tps.strides[0]) )))), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:       tpol[si+2*nchrom+n] = t[si+n]*tps[6*n+2]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = (__pyx_v_si + __pyx_v_n);
                            __pyx_t_5 = ((6 * __pyx_v_n) + 2);
                            __pyx_t_6 = ((__pyx_v_si + (2 * __pyx_v_nchrom)) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_6 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((*((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_4 * __pyx_v_t.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_tps.data + __pyx_t_5 * __pyx_v_tps.strides[0]) )))), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:       tpol[si+3*nchrom+n] = t[si+n]*tps[6*n+3]</pre>
<pre class='cython code score-0 '>                            __pyx_t_5 = (__pyx_v_si + __pyx_v_n);
                            __pyx_t_4 = ((6 * __pyx_v_n) + 3);
                            __pyx_t_6 = ((__pyx_v_si + (3 * __pyx_v_nchrom)) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_6 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((*((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_5 * __pyx_v_t.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_tps.data + __pyx_t_4 * __pyx_v_tps.strides[0]) )))), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:       tpol[si+4*nchrom+n] = t[si+n]*tps[6*n+4]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = (__pyx_v_si + __pyx_v_n);
                            __pyx_t_5 = ((6 * __pyx_v_n) + 4);
                            __pyx_t_6 = ((__pyx_v_si + (4 * __pyx_v_nchrom)) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_6 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((*((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_4 * __pyx_v_t.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_tps.data + __pyx_t_5 * __pyx_v_tps.strides[0]) )))), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:       tpol[si+5*nchrom+n] = t[si+n]*tps[6*n+5]</pre>
<pre class='cython code score-0 '>                            __pyx_t_5 = (__pyx_v_si + __pyx_v_n);
                            __pyx_t_4 = ((6 * __pyx_v_n) + 5);
                            __pyx_t_6 = ((__pyx_v_si + (5 * __pyx_v_nchrom)) + __pyx_v_n);
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_tpol.data + __pyx_t_6 * __pyx_v_tpol.strides[0]) )) = __pyx_t_double_complex_from_parts(((*((double *) ( /* dim=0 */ (__pyx_v_t.data + __pyx_t_5 * __pyx_v_t.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_tps.data + __pyx_t_4 * __pyx_v_tps.strides[0]) )))), 0);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">203</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">205</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>: cdef void RamanTCF(double complex [:] tpol, double complex [:] tpol0,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_RamanTCF(__Pyx_memviewslice __pyx_v_tpol, __Pyx_memviewslice __pyx_v_tpol0, __Pyx_memviewslice __pyx_v_Fmt, int __pyx_v_nchrom, double __pyx_v_tdt, double __pyx_v_rlx_time, __Pyx_memviewslice __pyx_v_vvtcf, __Pyx_memviewslice __pyx_v_vhtcf, int __pyx_v_it) {
  double __pyx_v_dts;
  __pyx_t_double_complex __pyx_v_xxxx;
  __pyx_t_double_complex __pyx_v_yyyy;
  __pyx_t_double_complex __pyx_v_zzzz;
  __pyx_t_double_complex __pyx_v_iiii;
  __pyx_t_double_complex __pyx_v_xxyy;
  __pyx_t_double_complex __pyx_v_yyxx;
  __pyx_t_double_complex __pyx_v_yyzz;
  __pyx_t_double_complex __pyx_v_zzyy;
  __pyx_t_double_complex __pyx_v_xxzz;
  __pyx_t_double_complex __pyx_v_zzxx;
  __pyx_t_double_complex __pyx_v_iijj;
  __pyx_t_double_complex __pyx_v_xyxy;
  __pyx_t_double_complex __pyx_v_xzxz;
  __pyx_t_double_complex __pyx_v_yzyz;
  __pyx_t_double_complex __pyx_v_ijij;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("RamanTCF", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">207</span>:                    double complex [:,:] Fmt, int nchrom, double tdt,</pre>
<pre class="cython line score-0">&#xA0;<span class="">208</span>:                    double rlx_time, double complex [:] vvtcf,</pre>
<pre class="cython line score-0">&#xA0;<span class="">209</span>:                    double complex [:] vhtcf, int it):</pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:    cdef double dts = -tdt/(2.0*rlx_time)</pre>
<pre class='cython code score-0 '>  __pyx_v_dts = ((-__pyx_v_tdt) / (2.0 * __pyx_v_rlx_time));
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>:    cdef double complex xxxx, yyyy, zzzz, iiii</pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>:    cdef double complex xxyy, yyxx, yyzz, zzyy, xxzz, zzxx, iijj</pre>
<pre class="cython line score-0">&#xA0;<span class="">214</span>:    cdef double complex xyxy, xzxz, yzyz, ijij</pre>
<pre class="cython line score-0">&#xA0;<span class="">215</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:    xxxx = respT(tpol, tpol0, Fmt, nchrom, 0, 0)</pre>
<pre class='cython code score-0 '>  __pyx_v_xxxx = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, 0, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:    yyyy = respT(tpol, tpol0, Fmt, nchrom, 3*nchrom, 3*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_yyyy = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (3 * __pyx_v_nchrom), (3 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:    zzzz = respT(tpol, tpol0, Fmt, nchrom, 5*nchrom, 5*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_zzzz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (5 * __pyx_v_nchrom), (5 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:    iiii = xxxx + yyyy + zzzz</pre>
<pre class='cython code score-0 '>  __pyx_v_iiii = __Pyx_c_sum_double(__Pyx_c_sum_double(__pyx_v_xxxx, __pyx_v_yyyy), __pyx_v_zzzz);
</pre><pre class="cython line score-0">&#xA0;<span class="">220</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:    xxyy = respT(tpol, tpol0, Fmt, nchrom, 3*nchrom, 0)</pre>
<pre class='cython code score-0 '>  __pyx_v_xxyy = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (3 * __pyx_v_nchrom), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:    yyxx = respT(tpol, tpol0, Fmt, nchrom, 0, 3*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_yyxx = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, 0, (3 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:    yyzz = respT(tpol, tpol0, Fmt, nchrom, 5*nchrom, 3*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_yyzz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (5 * __pyx_v_nchrom), (3 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:    zzyy = respT(tpol, tpol0, Fmt, nchrom, 3*nchrom, 5*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_zzyy = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (3 * __pyx_v_nchrom), (5 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:    xxzz = respT(tpol, tpol0, Fmt, nchrom, 5*nchrom, 0)</pre>
<pre class='cython code score-0 '>  __pyx_v_xxzz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (5 * __pyx_v_nchrom), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:    zzxx = respT(tpol, tpol0, Fmt, nchrom, 0, 5*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_zzxx = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, 0, (5 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:    iijj = xxyy + yyzz + xxzz + yyxx + zzyy + zzxx</pre>
<pre class='cython code score-0 '>  __pyx_v_iijj = __Pyx_c_sum_double(__Pyx_c_sum_double(__Pyx_c_sum_double(__Pyx_c_sum_double(__Pyx_c_sum_double(__pyx_v_xxyy, __pyx_v_yyzz), __pyx_v_xxzz), __pyx_v_yyxx), __pyx_v_zzyy), __pyx_v_zzxx);
</pre><pre class="cython line score-0">&#xA0;<span class="">228</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:    xyxy = respT(tpol, tpol0, Fmt, nchrom, nchrom, nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_xyxy = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, __pyx_v_nchrom, __pyx_v_nchrom);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:    xzxz = respT(tpol, tpol0, Fmt, nchrom, 2*nchrom, 2*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_xzxz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (2 * __pyx_v_nchrom), (2 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:    yzyz = respT(tpol, tpol0, Fmt, nchrom, 4*nchrom, 4*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_yzyz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_tpol0, __pyx_v_Fmt, __pyx_v_nchrom, (4 * __pyx_v_nchrom), (4 * __pyx_v_nchrom));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:    ijij = xyxy + xzxz + yzyz</pre>
<pre class='cython code score-0 '>  __pyx_v_ijij = __Pyx_c_sum_double(__Pyx_c_sum_double(__pyx_v_xyxy, __pyx_v_xzxz), __pyx_v_yzyz);
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:    vvtcf[it] += (3.0*iiii + iijj + 4.0*ijij)*exp(dts)/15.0;</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_it;
  *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_vvtcf.data + __pyx_t_1 * __pyx_v_vvtcf.strides[0]) )) += __Pyx_c_quot_double(__Pyx_c_prod_double(__Pyx_c_sum_double(__Pyx_c_sum_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(3.0, 0), __pyx_v_iiii), __pyx_v_iijj), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(4.0, 0), __pyx_v_ijij)), __pyx_t_double_complex_from_parts(exp(__pyx_v_dts), 0)), __pyx_t_double_complex_from_parts(15.0, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:    vhtcf[it] += (2.0*iiii - iijj + 6.0*ijij)*exp(dts)/30.0;</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_it;
  *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_vhtcf.data + __pyx_t_1 * __pyx_v_vhtcf.strides[0]) )) += __Pyx_c_quot_double(__Pyx_c_prod_double(__Pyx_c_sum_double(__Pyx_c_diff_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(2.0, 0), __pyx_v_iiii), __pyx_v_iijj), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(6.0, 0), __pyx_v_ijij)), __pyx_t_double_complex_from_parts(exp(__pyx_v_dts), 0)), __pyx_t_double_complex_from_parts(30.0, 0));
</pre><pre class="cython line score-0">&#xA0;<span class="">236</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">238</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>: cdef void sfgTCF(double complex [:] tpol, double complex [:] m0z,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_sfgTCF(__Pyx_memviewslice __pyx_v_tpol, __Pyx_memviewslice __pyx_v_m0z, __Pyx_memviewslice __pyx_v_Fmt, int __pyx_v_nchrom, double __pyx_v_tdt, double __pyx_v_rlx_time, __Pyx_memviewslice __pyx_v_ssptcf, int __pyx_v_it) {
  double __pyx_v_dts;
  __pyx_t_double_complex __pyx_v_xxz;
  __pyx_t_double_complex __pyx_v_yyz;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sfgTCF", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>:                  double complex [:,:] Fmt, int nchrom, double tdt,</pre>
<pre class="cython line score-0">&#xA0;<span class="">241</span>:                  double rlx_time, double complex [:] ssptcf, int it):</pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:    cdef double dts = -tdt/(2.0*rlx_time)</pre>
<pre class='cython code score-0 '>  __pyx_v_dts = ((-__pyx_v_tdt) / (2.0 * __pyx_v_rlx_time));
</pre><pre class="cython line score-0">&#xA0;<span class="">244</span>:    cdef double complex xxz, yyz</pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>:    # we need alpha_{xx} and f(z)*mu_{z}</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:    xxz = respT(tpol, m0z, Fmt, nchrom, 0, 0)</pre>
<pre class='cython code score-0 '>  __pyx_v_xxz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_m0z, __pyx_v_Fmt, __pyx_v_nchrom, 0, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">247</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>:    # and alpha_{yy} and f(z)*mu_{z}</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:    yyz = respT(tpol, m0z, Fmt, nchrom, 0, 3*nchrom)</pre>
<pre class='cython code score-0 '>  __pyx_v_yyz = __pyx_f_2la_respT(__pyx_v_tpol, __pyx_v_m0z, __pyx_v_Fmt, __pyx_v_nchrom, 0, (3 * __pyx_v_nchrom));
</pre><pre class="cython line score-0">&#xA0;<span class="">250</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:    ssptcf[it] += 0.5*(xxz + yyz)*exp(dts)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_it;
  *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_ssptcf.data + __pyx_t_1 * __pyx_v_ssptcf.strides[0]) )) += __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0.5, 0), __Pyx_c_sum_double(__pyx_v_xxz, __pyx_v_yyz)), __pyx_t_double_complex_from_parts(exp(__pyx_v_dts), 0));
</pre><pre class="cython line score-0">&#xA0;<span class="">252</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>:    # for PSP and PPP definitions see JPCB 119 8969</pre>
<pre class="cython line score-0">&#xA0;<span class="">254</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">256</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>: cdef void dipolesf(double complex [:] m_in, double complex [:] m_out,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_dipolesf(__Pyx_memviewslice __pyx_v_m_in, __Pyx_memviewslice __pyx_v_m_out, __Pyx_memviewslice __pyx_v_ssf, int __pyx_v_nchrom, CYTHON_UNUSED int __pyx_v_num_threads) {
  Py_ssize_t __pyx_v_n;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>:                    double [:] ssf, int nchrom, int num_threads) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">260</span>:    cdef Py_ssize_t n</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:    for n in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_2);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:       m_out[n] = m_in[2*nchrom+n]*ssf[n]</pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = ((2 * __pyx_v_nchrom) + __pyx_v_n);
                            __pyx_t_5 = __pyx_v_n;
                            __pyx_t_6 = __pyx_v_n;
                            *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_m_out.data + __pyx_t_6 * __pyx_v_m_out.strides[0]) )) = __Pyx_c_prod_double((*((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_m_in.data + __pyx_t_4 * __pyx_v_m_in.strides[0]) ))), __pyx_t_double_complex_from_parts((*((double *) ( /* dim=0 */ (__pyx_v_ssf.data + __pyx_t_5 * __pyx_v_ssf.strides[0]) ))), 0));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">263</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">265</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>: cdef void updateFFCF(double [:] ftcf, double *ww0, int nchrom, int ncorr,</pre>
<pre class='cython code score-0 '>static void __pyx_f_6uwater_updateFFCF(__Pyx_memviewslice __pyx_v_ftcf, double *__pyx_v_ww0, int __pyx_v_nchrom, int __pyx_v_ncorr, int __pyx_v_nseg, CYTHON_UNUSED int __pyx_v_num_threads) {
  Py_ssize_t __pyx_v_ns;
  Py_ssize_t __pyx_v_ts;
  Py_ssize_t __pyx_v_ms;
  double __pyx_v_norm;
  double __pyx_v_norm2;
  double *__pyx_v_w_avg;
/* … */
  /* function exit code */
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">267</span>:                      int nseg, int num_threads) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">269</span>:    cdef Py_ssize_t ns,ts,ms</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:    cdef double norm = nseg*ncorr</pre>
<pre class='cython code score-0 '>  __pyx_v_norm = (__pyx_v_nseg * __pyx_v_ncorr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:    cdef double norm2= nseg*nchrom</pre>
<pre class='cython code score-0 '>  __pyx_v_norm2 = (__pyx_v_nseg * __pyx_v_nchrom);
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:    w_avg = &lt;double *&gt; malloc(nchrom*sizeof(double))</pre>
<pre class='cython code score-0 '>  __pyx_v_w_avg = ((double *)malloc((__pyx_v_nchrom * (sizeof(double)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:    for ms in range(nchrom):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nchrom;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_ms = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:       w_avg[ms] = 0.0</pre>
<pre class='cython code score-0 '>    (__pyx_v_w_avg[__pyx_v_ms]) = 0.0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">276</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:    for ms in prange(nchrom, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_4 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_4 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_ms) lastprivate(__pyx_v_ms) lastprivate(__pyx_v_ns) lastprivate(__pyx_v_ts)        __pyx_t_1 = __pyx_v_nchrom;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_4 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_4 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_ms) lastprivate(__pyx_v_ms) lastprivate(__pyx_v_ns) lastprivate(__pyx_v_ts) num_threads(__pyx_v_num_threads)
                    #endif /* _OPENMP */
                    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_4; __pyx_t_3++){
                        {
                            __pyx_v_ms = (Py_ssize_t)(0 + 1 * __pyx_t_3);
                            /* Initialize private variables to invalid values */
                            __pyx_v_ns = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_ts = ((Py_ssize_t)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:       for ts in range(ncorr):</pre>
<pre class='cython code score-0 '>                            __pyx_t_2 = __pyx_v_ncorr;
                            __pyx_t_5 = __pyx_t_2;
                            for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
                              __pyx_v_ts = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:          for ns in range(nseg):</pre>
<pre class='cython code score-0 '>                              __pyx_t_7 = __pyx_v_nseg;
                              __pyx_t_8 = __pyx_t_7;
                              for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
                                __pyx_v_ns = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:             w_avg[ms] += ww0[ns*nchrom*ncorr+nchrom*ts+ms]/norm</pre>
<pre class='cython code score-0 '>                                __pyx_t_10 = __pyx_v_ms;
                                (__pyx_v_w_avg[__pyx_t_10]) = ((__pyx_v_w_avg[__pyx_t_10]) + ((__pyx_v_ww0[((((__pyx_v_ns * __pyx_v_nchrom) * __pyx_v_ncorr) + (__pyx_v_nchrom * __pyx_v_ts)) + __pyx_v_ms)]) / __pyx_v_norm));
                              }
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">281</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:    for ms in range(nchrom): #, num_threads=num_threads, nogil=True):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nchrom;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_2; __pyx_t_4+=1) {
    __pyx_v_ms = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:       for ts in range(ncorr):</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_ncorr;
    __pyx_t_7 = __pyx_t_5;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_7; __pyx_t_3+=1) {
      __pyx_v_ts = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:          for ns in range(nseg):</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_v_nseg;
      __pyx_t_11 = __pyx_t_8;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_11; __pyx_t_6+=1) {
        __pyx_v_ns = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:             ftcf[ts] += (ww0[ns*nchrom*ncorr+ms]-w_avg[ms])*(ww0[ns*nchrom*ncorr+nchrom*ts+ms]-w_avg[ms])</pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_ts;
        *((double *) ( /* dim=0 */ (__pyx_v_ftcf.data + __pyx_t_12 * __pyx_v_ftcf.strides[0]) )) += (((__pyx_v_ww0[(((__pyx_v_ns * __pyx_v_nchrom) * __pyx_v_ncorr) + __pyx_v_ms)]) - (__pyx_v_w_avg[__pyx_v_ms])) * ((__pyx_v_ww0[((((__pyx_v_ns * __pyx_v_nchrom) * __pyx_v_ncorr) + (__pyx_v_nchrom * __pyx_v_ts)) + __pyx_v_ms)]) - (__pyx_v_w_avg[__pyx_v_ms])));
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">286</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:    for ts in range(ncorr):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_ncorr;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_2; __pyx_t_4+=1) {
    __pyx_v_ts = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:       ftcf[ts] /= norm2</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_ts;
    *((double *) ( /* dim=0 */ (__pyx_v_ftcf.data + __pyx_t_12 * __pyx_v_ftcf.strides[0]) )) /= __pyx_v_norm2;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">289</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:    free (w_avg)</pre>
<pre class='cython code score-0 '>  free(__pyx_v_w_avg);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:    return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre></div></body></html>
